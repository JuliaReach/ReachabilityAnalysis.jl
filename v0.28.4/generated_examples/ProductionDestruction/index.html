<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Production-Destruction · ReachabilityAnalysis.jl</title><meta name="title" content="Production-Destruction · ReachabilityAnalysis.jl"/><meta property="og:title" content="Production-Destruction · ReachabilityAnalysis.jl"/><meta property="twitter:title" content="Production-Destruction · ReachabilityAnalysis.jl"/><meta name="description" content="Documentation for ReachabilityAnalysis.jl."/><meta property="og:description" content="Documentation for ReachabilityAnalysis.jl."/><meta property="twitter:description" content="Documentation for ReachabilityAnalysis.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/aligned.css" rel="stylesheet" type="text/css"/><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="ReachabilityAnalysis.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ReachabilityAnalysis.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Overview</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Set representations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/set_representations/zonotopes/">Zonotopic sets</a></li><li><a class="tocitem" href="../../tutorials/set_representations/polyhedral_computations/">Polyhedral computations</a></li><li><a class="tocitem" href="../../tutorials/set_representations/distances/">Metric notions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Linear methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/linear_methods/introduction/">Introduction</a></li><li><a class="tocitem" href="../../tutorials/linear_methods/discrete_time/">Discrete time reachability</a></li><li><a class="tocitem" href="../../tutorials/linear_methods/dense_time/">Dense time reachability</a></li><li><a class="tocitem" href="../ISS/">International Space Station</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Modeling uncertain inputs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../Building/">Building model</a></li><li><a class="tocitem" href="../OpAmp/">Operational amplifier</a></li><li><a class="tocitem" href="../TransmissionLine/">Transmission line</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Taylor methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/taylor_methods/introduction/">Introduction</a></li><li><a class="tocitem" href="../../tutorials/taylor_methods/domain_splitting/">Domain splitting</a></li><li><a class="tocitem" href="../../tutorials/taylor_methods/gotchas/">Common gotchas</a></li><li><a class="tocitem" href="../LotkaVolterra/">Lotka-Volterra</a></li><li><a class="tocitem" href="../VanDerPol/">Van der Pol oscillator</a></li><li><a class="tocitem" href="../Lorenz/">Lorenz system</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-5" type="checkbox"/><label class="tocitem" for="menuitem-2-5"><span class="docs-label">Parametric systems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../man/parametric/">Parametric reachability</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-6" type="checkbox"/><label class="tocitem" for="menuitem-2-6"><span class="docs-label">Hybrid systems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../SquareWaveOscillator/">Square wave oscillator</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-7" type="checkbox"/><label class="tocitem" for="menuitem-2-7"><span class="docs-label">Clocked systems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../Platoon/">Platoon</a></li><li><a class="tocitem" href="../EMBrake/">Electromechanical brake</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../man/systems/">Systems</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Linear solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../man/algorithms/A20/">A20</a></li><li><a class="tocitem" href="../../man/algorithms/ASB07/">ASB07</a></li><li><a class="tocitem" href="../../man/algorithms/BFFPSV18/">BFFPSV18</a></li><li><a class="tocitem" href="../../man/algorithms/BOX/">BOX</a></li><li><a class="tocitem" href="../../man/algorithms/GLGM06/">GLGM06</a></li><li><a class="tocitem" href="../../man/algorithms/INT/">INT</a></li><li><a class="tocitem" href="../../man/algorithms/LGG09/">LGG09</a></li><li><a class="tocitem" href="../../man/algorithms/ORBIT/">ORBIT</a></li><li><a class="tocitem" href="../../man/algorithms/VREP/">VREP</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Parametric solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../man/algorithms/HLBS25/">HLBS25</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Benchmarks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../man/benchmarks/repeatability/">Repeatability evaluations</a></li><li><a class="tocitem" href="../../man/benchmarks/model_library/">Model library</a></li><li><a class="tocitem" href="../../man/benchmarks/benchmarks/">Benchmark repository</a></li><li><a class="tocitem" href="../../man/benchmarks/filtered_oscillator/">Filtered oscillator</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox" checked/><label class="tocitem" for="menuitem-5"><span class="docs-label">Further examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../man/examples_overview/">Overview</a></li><li><a class="tocitem" href="../DuffingOscillator/">Duffing oscillator</a></li><li><a class="tocitem" href="../LaubLoomis/">Laub-Loomis</a></li><li class="is-active"><a class="tocitem" href>Production-Destruction</a><ul class="internal"><li><a class="tocitem" href="#Model-description"><span>Model description</span></a></li><li><a class="tocitem" href="#Specification"><span>Specification</span></a></li><li><a class="tocitem" href="#Analysis-and-Results"><span>Analysis &amp; Results</span></a></li></ul></li><li><a class="tocitem" href="../Brusselator/">Brusselator</a></li><li><a class="tocitem" href="../Quadrotor/">Quadrotor</a></li><li><a class="tocitem" href="../SEIR/">Epidemic (SEIR) model</a></li><li><a class="tocitem" href="../Spacecraft/">Spacecraft</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lib/systems/">Systems</a></li><li><a class="tocitem" href="../../lib/reachsets/">Reach-sets</a></li><li><a class="tocitem" href="../../lib/flowpipes/">Flowpipes</a></li><li><input class="collapse-toggle" id="menuitem-6-4" type="checkbox"/><label class="tocitem" for="menuitem-6-4"><span class="docs-label">Linear solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lib/algorithms/A20/">A20</a></li><li><a class="tocitem" href="../../lib/algorithms/ASB07/">ASB07</a></li><li><a class="tocitem" href="../../lib/algorithms/BFFPSV18/">BFFPSV18</a></li><li><a class="tocitem" href="../../lib/algorithms/BOX/">BOX</a></li><li><a class="tocitem" href="../../lib/algorithms/GLGM06/">GLGM06</a></li><li><a class="tocitem" href="../../lib/algorithms/INT/">INT</a></li><li><a class="tocitem" href="../../lib/algorithms/LGG09/">LGG09</a></li><li><a class="tocitem" href="../../lib/algorithms/ORBIT/">ORBIT</a></li><li><a class="tocitem" href="../../lib/algorithms/VREP/">VREP</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-5" type="checkbox"/><label class="tocitem" for="menuitem-6-5"><span class="docs-label">Nonlinear solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lib/algorithms/CARLIN/">CARLIN</a></li><li><a class="tocitem" href="../../lib/algorithms/QINT/">QINT</a></li><li><a class="tocitem" href="../../lib/algorithms/TMJets/">TMJets</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-6" type="checkbox"/><label class="tocitem" for="menuitem-6-6"><span class="docs-label">Parametric solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lib/algorithms/HLBS25/">HLBS25</a></li></ul></li><li><a class="tocitem" href="../../lib/solutions/">Solutions</a></li><li><a class="tocitem" href="../../lib/discretize/">Discretization</a></li><li><a class="tocitem" href="../../lib/projections/">Projections</a></li><li><a class="tocitem" href="../../lib/clustering/">Clustering</a></li><li><a class="tocitem" href="../../lib/operations/">Further set operations</a></li><li><a class="tocitem" href="../../lib/distributed/">Distributed computations</a></li><li><a class="tocitem" href="../../lib/internals/">Internal functions and macros</a></li></ul></li><li><a class="tocitem" href="../../man/faq/">Frequently Asked Questions (FAQ)</a></li><li><a class="tocitem" href="../../bibliography/">Bibliography</a></li><li><a class="tocitem" href="../../about/">How to contribute</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Further examples</a></li><li class="is-active"><a href>Production-Destruction</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Production-Destruction</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaReach/ReachabilityAnalysis.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaReach/ReachabilityAnalysis.jl/blob/master/examples/ProductionDestruction/ProductionDestruction.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Production/Destruction"><a class="docs-heading-anchor" href="#Production/Destruction">Production/Destruction</a><a id="Production/Destruction-1"></a><a class="docs-heading-anchor-permalink" href="#Production/Destruction" title="Permalink"></a></h1><div class="admonition is-info" id="Overview-f92de8aa06b096cf"><header class="admonition-header">Overview<a class="admonition-anchor" href="#Overview-f92de8aa06b096cf" title="Permalink"></a></header><div class="admonition-body"><p>System type: Rational continuous system<br/>State dimension: 3<br/>Application domain: Chemical kinetics</p></div></div><h2 id="Model-description"><a class="docs-heading-anchor" href="#Model-description">Model description</a><a id="Model-description-1"></a><a class="docs-heading-anchor-permalink" href="#Model-description" title="Permalink"></a></h2><p>A production-destruction system consists of an ordinary differential equation and two constraints: positivity and conservativity. It means that the system states are quantities which are always positive and their sum is constant. This particular family of systems is often used to test the stability of integration schemes.</p><p>As proposed by <strong>Michaelis-Menten</strong> theory [<a href="../../bibliography/#KopeczM18">KM18</a>], a model for three quantities can be defined as follows:</p><p class="math-container">\[\begin{aligned}
    \dot{x} &amp;= \dfrac{-xy}{1+x} \\[2mm]
    \dot{y} &amp;= \dfrac{xy}{1+x} - a y \\[2mm]
    \dot{z} &amp;= a y
\end{aligned}\]</p><p>with nominal value <span>$a = 0.3$</span> and an initial condition <span>$x(0) = 9.98$</span>, <span>$y(0) = 0.01$</span>, and <span>$z(0) = 0.01$</span>. In this model, <span>$x$</span> represents the nutrients, <span>$y$</span> the phytoplankton, and <span>$z$</span> the detritus. In this case study, we analyze the behavior of the system subject to uncertainties in the initial condition and/or the model&#39;s parameter <span>$a$</span>.</p><h2 id="Specification"><a class="docs-heading-anchor" href="#Specification">Specification</a><a id="Specification-1"></a><a class="docs-heading-anchor-permalink" href="#Specification" title="Permalink"></a></h2><p>The solution should satisfy the following two constraints:</p><ul><li><strong>Positivity</strong>: <span>$x(t)$</span>, <span>$y(t)$</span>, <span>$z(t)$</span> are positive, and</li><li><strong>Conservativity</strong>: <span>$x(t) + y(t) + z(t) = 10$</span> for all <span>$t ≥ 0$</span>.</li></ul><p>Here we are interested in computing the reachable tube until the time horizon <span>$T=100$</span> and to verify the constraints <span>$10 ∈ x+y+z$</span> and <span>$x, y, z ≥ 0$</span> at <span>$T = 100$</span>. Three setups are considered, depending on the source of bounded uncertainties:</p><ul><li><strong>Case I</strong>: <span>$x(0) ∈ [9.5, 10.0]$</span>, i.e., uncertainty in the initial condition;</li><li><strong>Case P</strong>: <span>$a ∈ [0.296, 0.304]$</span>, i.e., uncertainty in the parameter value;</li><li><strong>Case I &amp; P</strong>: <span>$x(0) ∈ [9.5, 10.0]$</span> and <span>$a ∈ [0.296, 0.304]$</span>, i.e., both uncertainties are present.</li></ul><p>The reachability settings considered above are a variation of those in <a href="../../bibliography/#GerettiSABCCCFF20">Geretti <em>et al.</em> [GSA+20]</a>. Note that variables <span>$x$</span> and <span>$y$</span> converge towards zero, so the final volume can be used as a quality measure of the overapproximation.</p><p>We consider two measures of quality of the approximation: the volume of the box (<span>$x × y × z$</span>) enclosing the final states (at <span>$T = 100$</span>) and the total time of computation for evolution and verification. These results are obtained for the three setups.</p><p>We discuss the implementation of each constraint satisfaction problem, beginning by defining the positive orthant in three-dimensional space, <code>positive_orthant</code>, as an unbounded polyhedron in constraint representation.</p><pre><code class="language-julia hljs">using ReachabilityAnalysis, Symbolics

@variables x y z
positive_orthant = HPolyhedron([x &gt;= 0, y &gt;= 0, z &gt;= 0], [x, y, z]);</code></pre><p>Given a set <span>$X ⊆ \mathbb{R}^n$</span>, checking whether the positivity constraint holds corresponds to checking whether <span>$X$</span> is included in the positive orthant. This computation can be done efficiently using the support function, which is available in <code>LazySets.jl</code>. Multiple dispatch takes care based on the types of the arguments in the call <code>X ⊆ positive_orthant</code> depending on the type of <span>$X$</span>.</p><p>On the other hand, given a set <span>$X$</span>, a quick way to check the conservativity constraint is to first overapproximate <span>$X$</span> with a box, then represent this box as a product-of-intervals (<code>IntervalBox</code>) <code>B</code>, and finally take the Minkowski sum of each interval, using <code>sum(B)</code>. This check is only sufficient; splitting <span>$X$</span> can be used to refine the check.</p><p>The verification problem is summarized in the function <code>prod_dest_verif</code>. It receives the solution of a reachability problem represented with a Taylor-model flowpipe and two optional arguments that specify the time horizon <code>T</code>, which defaults to <code>100</code>, and the conservativity condition given a target value <code>target</code>, which defaults to <code>10</code>. The function returns the tuple <code>(sat, vol)</code>. The first output, <code>sat</code>, is true if and only if the positivity and conservativity conditions are satisfied at the time horizon <code>T</code>. The second output, <code>vol</code>, corresponds to the volume of the box overapproximation of the final reach set.</p><pre><code class="language-julia hljs">function prod_dest_verif(sol; T=100.0, target=10.0)
    # obtain the final reach set and project onto the state variables x, y, z
    Xh = box_approximation(sol(T))
    X = project(Xh; vars=(1, 2, 3))

    # check that all variables are nonnegative
    nonnegative = X ⊆ positive_orthant

    # compute the volume
    vol = volume(X)

    # check that the target belongs to the Minkowski sum of the projections
    # onto each coordinate
    B = convert(IntervalBox, X) # get a product-of-intervals representation
    contains_target = target ∈ sum(B)

    return nonnegative &amp;&amp; contains_target, vol
end;</code></pre><h2 id="Analysis-and-Results"><a class="docs-heading-anchor" href="#Analysis-and-Results">Analysis &amp; Results</a><a id="Analysis-and-Results-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis-and-Results" title="Permalink"></a></h2><h3 id="Case-I"><a class="docs-heading-anchor" href="#Case-I">Case I</a><a id="Case-I-1"></a><a class="docs-heading-anchor-permalink" href="#Case-I" title="Permalink"></a></h3><p>Case <strong>I</strong> corresponds to uncertainty in the initial states. We begin by writing the system of differential equations in the function <code>prod_dest_I!</code>.</p><pre><code class="language-julia hljs">@taylorize function prod_dest_I!(du, u, p, t)
    local a = 0.3
    x, y, z = u

    xyx = (x * y) / (1 + x)
    ay = a * y

    du[1] = -xyx
    du[2] = xyx - ay
    du[3] = ay
    return du
end</code></pre><p>The initial states are uncertain in dimension <span>$x$</span>.</p><pre><code class="language-julia hljs">X0 = Hyperrectangle(; low=[9.5, 0.01, 0.01], high=[10, 0.01, 0.01])
prob = @ivp(x&#39; = prod_dest_I!(x), dim:3, x(0) ∈ X0);</code></pre><h4 id="Analysis"><a class="docs-heading-anchor" href="#Analysis">Analysis</a><a id="Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis" title="Permalink"></a></h4><pre><code class="language-julia hljs">sol = solve(prob; T=100.0, alg=TMJets(; abstol=1e-12, orderT=6, orderQ=1));</code></pre><p>Verify that the specification holds:</p><pre><code class="language-julia hljs">property, vol = prod_dest_verif(sol)
@assert property &quot;the property should be proven&quot;
vol</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.3472995827239226e-16</code></pre><h4 id="Results"><a class="docs-heading-anchor" href="#Results">Results</a><a id="Results-1"></a><a class="docs-heading-anchor-permalink" href="#Results" title="Permalink"></a></h4><p>We plot <span>$z$</span> over time.</p><pre><code class="language-julia hljs">using Plots

fig = plot(sol; vars=(0, 3), lc=:orange, c=:orange, alpha=0.3, lab=&quot;I&quot;, xlab=&quot;t&quot;, ylab=&quot;z&quot;)</code></pre><img src="92ef1805.png" alt="Example block output"/><h3 id="Case-P"><a class="docs-heading-anchor" href="#Case-P">Case P</a><a id="Case-P-1"></a><a class="docs-heading-anchor-permalink" href="#Case-P" title="Permalink"></a></h3><p>For the case of an uncertain parameter, we add a new state variable that corresponds to <span>$a$</span>, with constant (zero) dynamics.</p><pre><code class="language-julia hljs">@taylorize function prod_dest_IP!(du, u, p, t)
    x, y, z, a = u[1], u[2], u[3], u[4]

    xyx = (x * y) / (1 + x)
    ay = a * y

    du[1] = -xyx
    du[2] = xyx - ay
    du[3] = ay
    du[4] = zero(a)
    return du
end

X0 = Hyperrectangle(; low=[9.98, 0.01, 0.01, 0.296], high=[9.98, 0.01, 0.01, 0.304])
prob = @ivp(x&#39; = prod_dest_IP!(x), dim:4, x(0) ∈ X0);</code></pre><h4 id="Analysis-2"><a class="docs-heading-anchor" href="#Analysis-2">Analysis</a><a class="docs-heading-anchor-permalink" href="#Analysis-2" title="Permalink"></a></h4><pre><code class="language-julia hljs">sol = solve(prob; T=100.0, alg=TMJets(; abstol=9e-13, orderT=6, orderQ=1));</code></pre><p>Verify that the specification holds:</p><pre><code class="language-julia hljs">property, vol = prod_dest_verif(sol)
@assert property &quot;the property should be proven&quot;
vol</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1.4702608588936523e-24</code></pre><h4 id="Results-2"><a class="docs-heading-anchor" href="#Results-2">Results</a><a class="docs-heading-anchor-permalink" href="#Results-2" title="Permalink"></a></h4><p>We plot <span>$z$</span> over time.</p><pre><code class="language-julia hljs">fig = plot(sol; vars=(0, 3), lc=:blue, c=:blue, alpha=0.3, lab=&quot;P&quot;, xlab=&quot;t&quot;, ylab=&quot;z&quot;)</code></pre><img src="1b8c0a23.png" alt="Example block output"/><h3 id="Case-I-and-P"><a class="docs-heading-anchor" href="#Case-I-and-P">Case I &amp; P</a><a id="Case-I-and-P-1"></a><a class="docs-heading-anchor-permalink" href="#Case-I-and-P" title="Permalink"></a></h3><p>When uncertainty in both the initial states and the parameters are present, we can reuse the function <code>prod_dest_IP!</code>, but setting an uncertain initial condition and an uncertain parameter. Recall that we are interested in <span>$x(0) ∈ [9.5, 10.0]$</span> and <span>$a ∈ [0.296, 0.304]$</span>.</p><pre><code class="language-julia hljs">X0 = Hyperrectangle(; low=[9.5, 0.01, 0.01, 0.296], high=[10, 0.01, 0.01, 0.304])
prob = @ivp(x&#39; = prod_dest_IP!(x), dim:4, x(0) ∈ X0);</code></pre><h4 id="Analysis-3"><a class="docs-heading-anchor" href="#Analysis-3">Analysis</a><a class="docs-heading-anchor-permalink" href="#Analysis-3" title="Permalink"></a></h4><pre><code class="language-julia hljs">sol = solve(prob; T=100.0, alg=TMJets(; abstol=1e-12, orderT=6, orderQ=1));</code></pre><p>Verify that the specification holds:</p><pre><code class="language-julia hljs">property, vol = prod_dest_verif(sol)
@assert property &quot;the property should be proven&quot;
vol</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2.703239675065678e-16</code></pre><h4 id="Results-3"><a class="docs-heading-anchor" href="#Results-3">Results</a><a class="docs-heading-anchor-permalink" href="#Results-3" title="Permalink"></a></h4><p>We plot <span>$z$</span> over time.</p><pre><code class="language-julia hljs">fig = plot(sol; vars=(0, 3), lc=:red, c=:red, alpha=0.3, lab=&quot;I &amp; P&quot;, xlab=&quot;t&quot;, ylab=&quot;z&quot;)</code></pre><img src="84c45010.png" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../LaubLoomis/">« Laub-Loomis</a><a class="docs-footer-nextpage" href="../Brusselator/">Brusselator »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Thursday 27 November 2025 19:35">Thursday 27 November 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
