<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Van der Pol oscillator · ReachabilityAnalysis.jl</title><meta name="title" content="Van der Pol oscillator · ReachabilityAnalysis.jl"/><meta property="og:title" content="Van der Pol oscillator · ReachabilityAnalysis.jl"/><meta property="twitter:title" content="Van der Pol oscillator · ReachabilityAnalysis.jl"/><meta name="description" content="Documentation for ReachabilityAnalysis.jl."/><meta property="og:description" content="Documentation for ReachabilityAnalysis.jl."/><meta property="twitter:description" content="Documentation for ReachabilityAnalysis.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/aligned.css" rel="stylesheet" type="text/css"/><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="ReachabilityAnalysis.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ReachabilityAnalysis.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Overview</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Set representations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/set_representations/zonotopes/">Zonotopic sets</a></li><li><a class="tocitem" href="../../tutorials/set_representations/polyhedral_computations/">Polyhedral computations</a></li><li><a class="tocitem" href="../../tutorials/set_representations/distances/">Metric notions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Linear methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/linear_methods/introduction/">Introduction</a></li><li><a class="tocitem" href="../../tutorials/linear_methods/discrete_time/">Discrete time reachability</a></li><li><a class="tocitem" href="../../tutorials/linear_methods/dense_time/">Dense time reachability</a></li><li><a class="tocitem" href="../ISS/">International Space Station</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Modeling uncertain inputs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../Building/">Building model</a></li><li><a class="tocitem" href="../OpAmp/">Operational amplifier</a></li><li><a class="tocitem" href="../TransmissionLine/">Transmission line</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox" checked/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Taylor methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/taylor_methods/introduction/">Introduction</a></li><li><a class="tocitem" href="../../tutorials/taylor_methods/domain_splitting/">Domain splitting</a></li><li><a class="tocitem" href="../../tutorials/taylor_methods/gotchas/">Common gotchas</a></li><li><a class="tocitem" href="../LotkaVolterra/">Lotka-Volterra</a></li><li class="is-active"><a class="tocitem" href>Van der Pol oscillator</a><ul class="internal"><li><a class="tocitem" href="#Model-description"><span>Model description</span></a></li><li><a class="tocitem" href="#Specification"><span>Specification</span></a></li><li><a class="tocitem" href="#Analysis"><span>Analysis</span></a></li><li><a class="tocitem" href="#Results"><span>Results</span></a></li><li><a class="tocitem" href="#Invariant-Set"><span>Invariant Set</span></a></li><li><a class="tocitem" href="#Limit-cycle"><span>Limit cycle</span></a></li></ul></li><li><a class="tocitem" href="../Lorenz/">Lorenz system</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-5" type="checkbox"/><label class="tocitem" for="menuitem-2-5"><span class="docs-label">Parametric systems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../man/parametric/">Parametric reachability</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-6" type="checkbox"/><label class="tocitem" for="menuitem-2-6"><span class="docs-label">Hybrid systems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../SquareWaveOscillator/">Square wave oscillator</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-7" type="checkbox"/><label class="tocitem" for="menuitem-2-7"><span class="docs-label">Clocked systems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../Platoon/">Platoon</a></li><li><a class="tocitem" href="../EMBrake/">Electromechanical brake</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../man/systems/">Systems</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Linear solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../man/algorithms/A20/">A20</a></li><li><a class="tocitem" href="../../man/algorithms/ASB07/">ASB07</a></li><li><a class="tocitem" href="../../man/algorithms/BFFPSV18/">BFFPSV18</a></li><li><a class="tocitem" href="../../man/algorithms/BOX/">BOX</a></li><li><a class="tocitem" href="../../man/algorithms/GLGM06/">GLGM06</a></li><li><a class="tocitem" href="../../man/algorithms/INT/">INT</a></li><li><a class="tocitem" href="../../man/algorithms/LGG09/">LGG09</a></li><li><a class="tocitem" href="../../man/algorithms/ORBIT/">ORBIT</a></li><li><a class="tocitem" href="../../man/algorithms/VREP/">VREP</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Parametric solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../man/algorithms/HLBS25/">HLBS25</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Benchmarks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../man/benchmarks/repeatability/">Repeatability evaluations</a></li><li><a class="tocitem" href="../../man/benchmarks/model_library/">Model library</a></li><li><a class="tocitem" href="../../man/benchmarks/benchmarks/">Benchmark repository</a></li><li><a class="tocitem" href="../../man/benchmarks/filtered_oscillator/">Filtered oscillator</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Further examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../man/examples_overview/">Overview</a></li><li><a class="tocitem" href="../DuffingOscillator/">Duffing oscillator</a></li><li><a class="tocitem" href="../LaubLoomis/">Laub-Loomis</a></li><li><a class="tocitem" href="../ProductionDestruction/">Production-Destruction</a></li><li><a class="tocitem" href="../Brusselator/">Brusselator</a></li><li><a class="tocitem" href="../Quadrotor/">Quadrotor</a></li><li><a class="tocitem" href="../SEIR/">Epidemic (SEIR) model</a></li><li><a class="tocitem" href="../Spacecraft/">Spacecraft</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lib/systems/">Systems</a></li><li><a class="tocitem" href="../../lib/reachsets/">Reach-sets</a></li><li><a class="tocitem" href="../../lib/flowpipes/">Flowpipes</a></li><li><input class="collapse-toggle" id="menuitem-6-4" type="checkbox"/><label class="tocitem" for="menuitem-6-4"><span class="docs-label">Linear solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lib/algorithms/A20/">A20</a></li><li><a class="tocitem" href="../../lib/algorithms/ASB07/">ASB07</a></li><li><a class="tocitem" href="../../lib/algorithms/BFFPSV18/">BFFPSV18</a></li><li><a class="tocitem" href="../../lib/algorithms/BOX/">BOX</a></li><li><a class="tocitem" href="../../lib/algorithms/GLGM06/">GLGM06</a></li><li><a class="tocitem" href="../../lib/algorithms/INT/">INT</a></li><li><a class="tocitem" href="../../lib/algorithms/LGG09/">LGG09</a></li><li><a class="tocitem" href="../../lib/algorithms/ORBIT/">ORBIT</a></li><li><a class="tocitem" href="../../lib/algorithms/VREP/">VREP</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-5" type="checkbox"/><label class="tocitem" for="menuitem-6-5"><span class="docs-label">Nonlinear solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lib/algorithms/CARLIN/">CARLIN</a></li><li><a class="tocitem" href="../../lib/algorithms/QINT/">QINT</a></li><li><a class="tocitem" href="../../lib/algorithms/TMJets/">TMJets</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-6" type="checkbox"/><label class="tocitem" for="menuitem-6-6"><span class="docs-label">Parametric solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lib/algorithms/HLBS25/">HLBS25</a></li></ul></li><li><a class="tocitem" href="../../lib/solutions/">Solutions</a></li><li><a class="tocitem" href="../../lib/discretize/">Discretization</a></li><li><a class="tocitem" href="../../lib/projections/">Projections</a></li><li><a class="tocitem" href="../../lib/clustering/">Clustering</a></li><li><a class="tocitem" href="../../lib/operations/">Further set operations</a></li><li><a class="tocitem" href="../../lib/distributed/">Distributed computations</a></li><li><a class="tocitem" href="../../lib/internals/">Internal functions and macros</a></li></ul></li><li><a class="tocitem" href="../../man/faq/">Frequently Asked Questions (FAQ)</a></li><li><a class="tocitem" href="../../bibliography/">Bibliography</a></li><li><a class="tocitem" href="../../about/">How to contribute</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li><a class="is-disabled">Taylor methods</a></li><li class="is-active"><a href>Van der Pol oscillator</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Van der Pol oscillator</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaReach/ReachabilityAnalysis.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaReach/ReachabilityAnalysis.jl/blob/master/examples/VanDerPol/VanDerPol.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Van-der-Pol-oscillator"><a class="docs-heading-anchor" href="#Van-der-Pol-oscillator">Van der Pol oscillator</a><a id="Van-der-Pol-oscillator-1"></a><a class="docs-heading-anchor-permalink" href="#Van-der-Pol-oscillator" title="Permalink"></a></h1><div class="admonition is-info" id="Overview-2ac13769e739b8e7"><header class="admonition-header">Overview<a class="admonition-anchor" href="#Overview-2ac13769e739b8e7" title="Permalink"></a></header><div class="admonition-body"><p>System type: Polynomial continuous system<br/>State dimension: 2<br/>Application domain: Nonlinear physics</p></div></div><p>The Van der Pol oscillator was introduced by the Dutch physicist Balthasar van der Pol. This is a famous model, typically investigated in the study of nonlinear dynamics. The model presents non-conservative oscillations with non-linear damping. In the past, it has been of relevance in several practical problems of engineering such as circuits containing vacuum tubes. For more information on the model, see <a href="https://en.wikipedia.org/wiki/Van_der_Pol_oscillator">Wikipedia</a>.</p><p>Here we compute the evolution of the limit cycle in the phase plane for a set of initial conditions. For this set, we consider a safety property, originally from <a href="../../bibliography/#AlthoffBFFK0SS19">Althoff <em>et al.</em> [ABF+19]</a>, that there is no solution starting from the initial set that exceeds a prescribed upper bound on the velocity <span>$y(t) := x&#39;(t)$</span> at all times in the given time span. Moreover, we also illustrate the computation of an invariant set using the obtained flowipe. Finally, we study the limit cycle à la Poincaré by defining a function that computes the cross section of the flowpipe at each revolution. Interestingly, this method gives an algorithmic proof that the safety condition obtained previously is actually verified at all times, i.e. over the unbounded time horizon <span>$[0, ∞)$</span>.</p><h2 id="Model-description"><a class="docs-heading-anchor" href="#Model-description">Model description</a><a id="Model-description-1"></a><a class="docs-heading-anchor-permalink" href="#Model-description" title="Permalink"></a></h2><p>The dynamics of the Van der Pol oscillator are described by the following differential equations with two variables:</p><p class="math-container">\[\begin{aligned}
    \dot{x} &amp;= y \\
    \dot{y} &amp;= μ (1 - x^2) y - x
\end{aligned}\]</p><p>The system has a stable limit cycle. This limit cycle becomes increasingly sharp for higher values <span>$μ$</span>. Here we consider the parameter <span>$μ = 1$</span>.</p><pre><code class="language-julia hljs">using ReachabilityAnalysis

@taylorize function vanderpol!(du, u, p, t)
    x, y = u
    local μ = 1.0
    du[1] = y
    du[2] = (μ * y) * (1 - x^2) - x
    return du
end</code></pre><div class="admonition is-success" id="Performance-tip-36899e46cd24fc2f"><header class="admonition-header">Performance tip<a class="admonition-anchor" href="#Performance-tip-36899e46cd24fc2f" title="Permalink"></a></header><div class="admonition-body"><p>Advanced users may want to consider the section <a href="../../tutorials/taylor_methods/gotchas/#Some-common-gotchas">Some common gotchas</a> to improve the code that is generated by <code>@taylorize</code> by re-writing the right-hand side of <code>dx[2]</code> with the use of auxiliary variables.</p></div></div><h2 id="Specification"><a class="docs-heading-anchor" href="#Specification">Specification</a><a id="Specification-1"></a><a class="docs-heading-anchor-permalink" href="#Specification" title="Permalink"></a></h2><p>We set the initial condition <span>$x(0) ∈ [1.25, 1.55]$</span>, <span>$y(0) ∈ [2.35,2.45]$</span>. The <em>unsafe set</em> is given by <span>$y ≥ 2.75$</span> for a time span <span>$[0, 7]$</span>. In other words, we would like to prove that there does not exist a solution of the model with a <span>$y$</span> value which is greater than 2.75, for any initial condition from the given domain. The time horizon <span>$T = 7$</span> is chosen such that the oscillator can do at least one full cycle.</p><pre><code class="language-julia hljs">X0 = Hyperrectangle(; low=[1.25, 2.35], high=[1.55, 2.45])
prob = @ivp(x&#39; = vanderpol!(x), dim:2, x(0) ∈ X0);</code></pre><h2 id="Analysis"><a class="docs-heading-anchor" href="#Analysis">Analysis</a><a id="Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis" title="Permalink"></a></h2><pre><code class="language-julia hljs">sol = solve(prob; T=7.0, alg=TMJets(; abstol=1e-12));</code></pre><p>For further computations, it is convenient to work with a <a href="https://juliareach.github.io/ReachabilityAnalysis.jl/dev/man/basics/#Zonotopes-1">zonotopic</a> overapproximation of the flowpipe.</p><pre><code class="language-julia hljs">solz = overapproximate(sol, Zonotope);</code></pre><p>The maximum value of variable <span>$y$</span> is obtained by computing the <a href="https://juliareach.github.io/ReachabilityAnalysis.jl/dev/man/basics/#Representing-sets-with-support-functions-1">support function</a> of the flowpipe along direction <span>$[0, 1]$</span>:</p><pre><code class="language-julia hljs">y_bound = ρ([0.0, 1.0], solz)
@assert y_bound &lt; 2.75 &quot;the property should be proven&quot;
y_bound</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2.724977587223378</code></pre><p>This shows that the property is satisfied. Below we plot the flowpipe in the x-y plane, together with the horizontal line <span>$y = 2.75$</span>.</p><h2 id="Results"><a class="docs-heading-anchor" href="#Results">Results</a><a id="Results-1"></a><a class="docs-heading-anchor-permalink" href="#Results" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Plots

fig = plot(solz; vars=(1, 2), lw=0.2, xlims=(-2.5, 2.5), xlab=&quot;x&quot;, ylab=&quot;y&quot;)
plot!(x -&gt; 2.75; color=:red, lab=&quot;y = 2.75&quot;, ls=:dash, legend=:bottomright)</code></pre><img src="b19ab3ef.png" alt="Example block output"/><p>We can also plot the state variables <span>$x(t)$</span> and <span>$y(t)$</span> as a function of time (recall that <code>0</code> in <code>vars</code> is used to denote the time variable):</p><pre><code class="language-julia hljs">fig = plot(solz; vars=(0, 1), lw=0.2, xlab=&quot;t&quot;, ylab=&quot;x&quot;)</code></pre><img src="e937cfe7.png" alt="Example block output"/><pre><code class="language-julia hljs">fig = plot(solz; vars=(0, 2), lw=0.2, xlab=&quot;t&quot;, ylab=&quot;y&quot;)</code></pre><img src="fc5efe2a.png" alt="Example block output"/><h2 id="Invariant-Set"><a class="docs-heading-anchor" href="#Invariant-Set">Invariant Set</a><a id="Invariant-Set-1"></a><a class="docs-heading-anchor-permalink" href="#Invariant-Set" title="Permalink"></a></h2><p>We can use the reachability result to examine an invariant of the system. In other words, we can algorithmically prove that the flowpipe re-enters from where it started after one loop iteration, using inclusion checks.</p><pre><code class="language-julia hljs">fig = plot(solz; vars=(1, 2), lw=0.2, xlims=(0.0, 2.5), ylims=(1.6, 2.8), xlab=&quot;x&quot;, ylab=&quot;y&quot;)
plot!(solz[1:13]; vars=(1, 2), color=:green, lw=1, alpha=0.5, lab=&quot;F[1:13]&quot;)
plot!(solz[388]; vars=(1, 2), color=:red, lw=1, alpha=0.6, lab=&quot;F[388]&quot;)</code></pre><img src="e61ead12.png" alt="Example block output"/><p>It can be seen that the reach set at index 388 corresponding to the time-span</p><pre><code class="language-julia hljs">tspan(solz[388])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[6.74967, 6.7599]</code></pre><p>is included in the set union <span>$F[1] ∪ \cdots ∪ F[13]$</span> of previously computed reach sets. Notice that all future trajectories starting from the 388-th reach set are already covered by the flowpipe. Therefore, we have found an <em>invariant set</em>.</p><h2 id="Limit-cycle"><a class="docs-heading-anchor" href="#Limit-cycle">Limit cycle</a><a id="Limit-cycle-1"></a><a class="docs-heading-anchor-permalink" href="#Limit-cycle" title="Permalink"></a></h2><p>To examine the limit cycle, we can intersect a line segment perpendicular to the flowpipe, which will allow us to get a cross section of the sets in order to prove that after one cycle the intersection segment actually shrinks. This approach is similar to the method of <a href="https://en.wikipedia.org/wiki/Poincar%C3%A9_map">Poincaré sections</a>.</p><pre><code class="language-julia hljs">line = LineSegment([1, 2.0], [2.0, 2.5])
fig = plot(solz; vars=(1, 2), lw=0.2, xlims=(0.0, 2.5), ylims=(1.6, 2.8), xlab=&quot;x&quot;, ylab=&quot;y&quot;)
plot!(solz[1:13]; vars=(1, 2), color=:green, lw=1.0, alpha=0.5, lab=&quot;F[1:13]&quot;)
plot!(solz[388]; vars=(1, 2), color=:red, lw=1.0, alpha=0.6, lab=&quot;F[388]&quot;)
plot!(line; lw=2.0)</code></pre><img src="2741bdd8.png" alt="Example block output"/><p>Next, we define a function to get the cross section of the flowpipe. The function needs the flowpipe, a line segment that cuts the flowpipe, and the indices of the subsets to cut.</p><pre><code class="language-julia hljs">function cross_section(line::LineSegment, F, idx)
    p = VPolygon()
    for i in idx
        x = intersection(line, set(F[i]))
        if !isempty(x)
            p = convex_hull(p, x)
        end
    end
    vl = vertices_list(p)
    @assert length(vl) == 2
    return LineSegment(vl[1], vl[2])
end;</code></pre><p>Then we can get the cross section of the first 13 sets and the last set.</p><pre><code class="language-julia hljs">ifirst = cross_section(line, solz, 1:13)
ilast = cross_section(line, solz, [388]);</code></pre><p>We can also calculate the length of each cross section.</p><pre><code class="language-julia hljs">lfirst = norm(ifirst.q - ifirst.p)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.28930757953811087</code></pre><pre><code class="language-julia hljs">llast = norm(ilast.q - ilast.p)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.11046336365917839</code></pre><pre><code class="language-julia hljs">fig = plot(ifirst; lw=3.0, alpha=1.0, label=&quot;First subsets&quot;, legend=:bottomright)
plot!(ilast; lw=5.0, alpha=1.0, label=&quot;Last subset&quot;)</code></pre><img src="801fe4cc.png" alt="Example block output"/><p>The inclusion check succeeds:</p><pre><code class="language-julia hljs">@assert ilast ⊆ ifirst &quot;the cross section should get smaller&quot;</code></pre><p>As we can see, the cross section of the last reach set is a subset of the first 13 reach sets. Thus, the cycle will continue, presumably getting smaller each revolution.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../LotkaVolterra/">« Lotka-Volterra</a><a class="docs-footer-nextpage" href="../Lorenz/">Lorenz system »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Thursday 13 November 2025 21:04">Thursday 13 November 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
