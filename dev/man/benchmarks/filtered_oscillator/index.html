<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Filtered oscillator · ReachabilityAnalysis.jl</title><meta name="title" content="Filtered oscillator · ReachabilityAnalysis.jl"/><meta property="og:title" content="Filtered oscillator · ReachabilityAnalysis.jl"/><meta property="twitter:title" content="Filtered oscillator · ReachabilityAnalysis.jl"/><meta name="description" content="Documentation for ReachabilityAnalysis.jl."/><meta property="og:description" content="Documentation for ReachabilityAnalysis.jl."/><meta property="twitter:description" content="Documentation for ReachabilityAnalysis.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/aligned.css" rel="stylesheet" type="text/css"/><link href="../../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="ReachabilityAnalysis.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">ReachabilityAnalysis.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Overview</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Set representations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../tutorials/set_representations/zonotopes/">Zonotopic sets</a></li><li><a class="tocitem" href="../../../tutorials/set_representations/polyhedral_computations/">Polyhedral computations</a></li><li><a class="tocitem" href="../../../tutorials/set_representations/distances/">Metric notions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Linear methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../tutorials/linear_methods/introduction/">Introduction</a></li><li><a class="tocitem" href="../../../tutorials/linear_methods/discrete_time/">Discrete time reachability</a></li><li><a class="tocitem" href="../../../tutorials/linear_methods/dense_time/">Dense time reachability</a></li><li><a class="tocitem" href="../../../generated_examples/ISS/">International Space Station</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Modeling uncertain inputs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated_examples/Building/">Building model</a></li><li><a class="tocitem" href="../../../generated_examples/OpAmp/">Operational amplifier</a></li><li><a class="tocitem" href="../../../generated_examples/TransmissionLine/">Transmission line</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Taylor methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../tutorials/taylor_methods/introduction/">Introduction</a></li><li><a class="tocitem" href="../../../tutorials/taylor_methods/domain_splitting/">Domain splitting</a></li><li><a class="tocitem" href="../../../tutorials/taylor_methods/gotchas/">Common gotchas</a></li><li><a class="tocitem" href="../../../generated_examples/LotkaVolterra/">Lotka-Volterra</a></li><li><a class="tocitem" href="../../../generated_examples/VanDerPol/">Van der Pol oscillator</a></li><li><a class="tocitem" href="../../../generated_examples/Lorenz/">Lorenz system</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-5" type="checkbox"/><label class="tocitem" for="menuitem-2-5"><span class="docs-label">Parametric systems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../parametric/">Parametric reachability</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-6" type="checkbox"/><label class="tocitem" for="menuitem-2-6"><span class="docs-label">Hybrid systems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated_examples/SquareWaveOscillator/">Square wave oscillator</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-7" type="checkbox"/><label class="tocitem" for="menuitem-2-7"><span class="docs-label">Clocked systems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated_examples/Platoon/">Platoon</a></li><li><a class="tocitem" href="../../../generated_examples/EMBrake/">Electromechanical brake</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../systems/">Systems</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Linear solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../algorithms/A20/">A20</a></li><li><a class="tocitem" href="../../algorithms/ASB07/">ASB07</a></li><li><a class="tocitem" href="../../algorithms/BFFPSV18/">BFFPSV18</a></li><li><a class="tocitem" href="../../algorithms/BOX/">BOX</a></li><li><a class="tocitem" href="../../algorithms/GLGM06/">GLGM06</a></li><li><a class="tocitem" href="../../algorithms/INT/">INT</a></li><li><a class="tocitem" href="../../algorithms/LGG09/">LGG09</a></li><li><a class="tocitem" href="../../algorithms/ORBIT/">ORBIT</a></li><li><a class="tocitem" href="../../algorithms/VREP/">VREP</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Parametric solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../algorithms/HLBS25/">HLBS25</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">Benchmarks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../repeatability/">Repeatability evaluations</a></li><li><a class="tocitem" href="../model_library/">Model library</a></li><li><a class="tocitem" href="../benchmarks/">Benchmark repository</a></li><li class="is-active"><a class="tocitem" href>Filtered oscillator</a><ul class="internal"><li><a class="tocitem" href="#Scalability-evaluation"><span>Scalability evaluation</span></a></li><li><a class="tocitem" href="#Results"><span>Results</span></a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Further examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples_overview/">Overview</a></li><li><a class="tocitem" href="../../../generated_examples/DuffingOscillator/">Duffing oscillator</a></li><li><a class="tocitem" href="../../../generated_examples/LaubLoomis/">Laub-Loomis</a></li><li><a class="tocitem" href="../../../generated_examples/ProductionDestruction/">Production-Destruction</a></li><li><a class="tocitem" href="../../../generated_examples/Brusselator/">Brusselator</a></li><li><a class="tocitem" href="../../../generated_examples/Quadrotor/">Quadrotor</a></li><li><a class="tocitem" href="../../../generated_examples/SEIR/">Epidemic (SEIR) model</a></li><li><a class="tocitem" href="../../../generated_examples/Spacecraft/">Spacecraft</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../lib/systems/">Systems</a></li><li><a class="tocitem" href="../../../lib/reachsets/">Reach-sets</a></li><li><a class="tocitem" href="../../../lib/flowpipes/">Flowpipes</a></li><li><input class="collapse-toggle" id="menuitem-6-4" type="checkbox"/><label class="tocitem" for="menuitem-6-4"><span class="docs-label">Linear solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../lib/algorithms/A20/">A20</a></li><li><a class="tocitem" href="../../../lib/algorithms/ASB07/">ASB07</a></li><li><a class="tocitem" href="../../../lib/algorithms/BFFPSV18/">BFFPSV18</a></li><li><a class="tocitem" href="../../../lib/algorithms/BOX/">BOX</a></li><li><a class="tocitem" href="../../../lib/algorithms/GLGM06/">GLGM06</a></li><li><a class="tocitem" href="../../../lib/algorithms/INT/">INT</a></li><li><a class="tocitem" href="../../../lib/algorithms/LGG09/">LGG09</a></li><li><a class="tocitem" href="../../../lib/algorithms/ORBIT/">ORBIT</a></li><li><a class="tocitem" href="../../../lib/algorithms/VREP/">VREP</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-5" type="checkbox"/><label class="tocitem" for="menuitem-6-5"><span class="docs-label">Nonlinear solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../lib/algorithms/CARLIN/">CARLIN</a></li><li><a class="tocitem" href="../../../lib/algorithms/QINT/">QINT</a></li><li><a class="tocitem" href="../../../lib/algorithms/TMJets/">TMJets</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-6" type="checkbox"/><label class="tocitem" for="menuitem-6-6"><span class="docs-label">Parametric solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../lib/algorithms/HLBS25/">HLBS25</a></li></ul></li><li><a class="tocitem" href="../../../lib/solutions/">Solutions</a></li><li><a class="tocitem" href="../../../lib/discretize/">Discretization</a></li><li><a class="tocitem" href="../../../lib/projections/">Projections</a></li><li><a class="tocitem" href="../../../lib/clustering/">Clustering</a></li><li><a class="tocitem" href="../../../lib/operations/">Further set operations</a></li><li><a class="tocitem" href="../../../lib/distributed/">Distributed computations</a></li><li><a class="tocitem" href="../../../lib/internals/">Internal functions and macros</a></li></ul></li><li><a class="tocitem" href="../../faq/">Frequently Asked Questions (FAQ)</a></li><li><a class="tocitem" href="../../../bibliography/">Bibliography</a></li><li><a class="tocitem" href="../../../about/">How to contribute</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Benchmarks</a></li><li class="is-active"><a href>Filtered oscillator</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Filtered oscillator</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaReach/ReachabilityAnalysis.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaReach/ReachabilityAnalysis.jl/blob/master/docs/src/man/benchmarks/filtered_oscillator.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h2 id="Scalability-evaluation"><a class="docs-heading-anchor" href="#Scalability-evaluation">Scalability evaluation</a><a id="Scalability-evaluation-1"></a><a class="docs-heading-anchor-permalink" href="#Scalability-evaluation" title="Permalink"></a></h2><p>Scalability is very important in the applicability of a tool. For illustration purposes, in this section we consider the scalability of the hybrid reachability solver, using different algorithm choices, for the filtered switched oscillator model from <a href="../../../bibliography/#FrehseGDCRLRGDM11">Frehse <em>et al.</em> [FLD+11]</a>. The model consists of a two-dimensional switched oscillator and a parametric number of filters which are used to <em>smooth</em> the oscilllator&#39;s state. An interesting aspect of the model is that it is scalable: the total number of continuous variables can be made arbitrarily large. Moreover, this is a challenging benchmark since several dozens of reach-sets may take each discrete jumps, hence clustering methods are indispensable.</p><p>The continuous variables <span>$x$</span> and <span>$y$</span> are used to denote the state of the oscillator, and the remaining <span>$m$</span> variables are used for the state of the filters. In this evaluation we consider that the number of filters ranges from 64 to 1024. To measure the quality of the approximations, we consider the safety property given by <span>$y(t) &lt; 0.5$</span> for all <span>$t ∈ [0, T]$</span>.</p><p>The filtered oscillator was also studied in <a href="../../../bibliography/#BogomolovFFVPS18">Bogomolov <em>et al.</em> [BFF+18]</a> to test the scalability of a new scheme that exploits the sparsity of the hybrid automaton to efficiently compute flowpipe-guard intersections. Such scheme is not considered in this section.</p><p>Recall that for a system of <span>$n$</span> variables, a box overapproximation requires to compute <span>$n$</span> samples of the approximation boundary, whereas an octagon requires <span>$O(n^2)$</span> many. Hence, using an octagon template, while gives tighter results in general, may incur in much higher computational cost if <span>$n$</span> is high.</p><h3 id="Model"><a class="docs-heading-anchor" href="#Model">Model</a><a id="Model-1"></a><a class="docs-heading-anchor-permalink" href="#Model" title="Permalink"></a></h3><pre><code class="language-julia hljs">using ReachabilityAnalysis

one_loop_iteration = false
n0 = 4
n1 = (one_loop_iteration ? n0 + 1 : n0)
n = n1 + 2
z = zeros(n1)

## common flow
A = zeros(n, n)
A[1,1], A[2,2] = -2., -1.
A[3,1], A[3,3] = 5., -5.
for i = 4 : n-1
    A[i,i-1], A[i,i] = 5., -5.
end

function mode1(z)
    b = [1.4; -0.7; z]
    X = HPolyhedron([HalfSpace([-0.714286; -1.0; z], 0.0),  # 0.714286*x + y &gt;= 0
                     HalfSpace([1.0; 0.0; z], 0.0)])  # x &lt;= 0
    @system(x&#39; = Ax + b, x ∈ X)
end

function mode2(z)
    b = [-1.4; 0.7; z]
    X = HPolyhedron([HalfSpace([1.0; 0.0; z], 0.0),  # x &lt;= 0
                     HalfSpace([0.714286; 1.0; z], 0.0)])  # 0.714286*x + y &lt;= 0
    @system(x&#39; = Ax + b, x ∈ X)
end

function mode3(z)
    b = [1.4; -0.7; z]
    X = HPolyhedron([HalfSpace([-1.0; 0.0; z], 0.0),  # x &gt;= 0
                     HalfSpace([-0.714286; -1.0; z], 0.0)])  # 0.714286*x + y &gt;= 0
    @system(x&#39; = Ax + b, x ∈ X)
end

function mode4(z, one_loop_iteration)
    b = [-1.4; 0.7; z]
    X = HPolyhedron([HalfSpace([0.714286; 1.0; z], 0.0),  # 0.714286*x + y &lt;= 0
                     HalfSpace([-1.0; 0.0; z], 0.0)])  # x &gt;= 0

    if one_loop_iteration
        ## k &lt;= 2 (2.1 to avoid numerical issues)
        addconstraint!(X, HalfSpace([zeros(n-1); 1.], 2.1))
    end
    @system(x&#39; = Ax + b, x ∈ X)
end


function filtered_oscillator_hybrid(n0, one_loop_iteration)

    n1 = (one_loop_iteration ? n0 + 1 : n0)
    n = n1 + 2
    z = zeros(n1)

    ## transition graph (automaton)
    a = GraphAutomaton(4)
    add_transition!(a, 3, 4, 1)
    add_transition!(a, 4, 2, 2)
    add_transition!(a, 2, 1, 3)
    add_transition!(a, 1, 3, 4)

    mode1 = mode1(z)
    mode2 = mode2(z)
    mode3 = mode3(z)
    mode4 = mode4(z, one_loop_iteration)
    m = [mode1, mode2, mode3, mode4]

    ## transitions

    ## transition l3 -&gt; l4
    X_l3l4 = HPolyhedron([HalfSpace([-1.0; 0.0; z], 0.0),  # x &gt;= 0
                          HalfSpace([-0.714286; -1.0; z], 0.0),  # 0.714286*x + y &gt;= 0
                          HalfSpace([0.714286; 1.0; z], 0.0)])  # 0.714286*x + y &lt;= 0
    if one_loop_iteration
        A_trans_34 = Matrix(1.0I, n, n)
        A_trans_34[n, n] = 2.  # k&#39; = k * 2
        r1 = ConstrainedLinearMap(A_trans_34, X_l3l4)
    else
        r1 = ConstrainedIdentityMap(n, X_l3l4)
    end

    ## transition l4 -&gt; l2
    X_l4l2 = HPolyhedron([HalfSpace([0.714286; 1.0; z], 0.0),  # 0.714286*x + y &lt;= 0
                          HalfSpace([-1.0; 0.0; z], 0.0),  # x &gt;= 0
                          HalfSpace([1.0; 0.0; z], 0.0)])  # x &lt;= 0
    r2 = ConstrainedIdentityMap(n, X_l4l2)

    ## transition l2 -&gt; l1
    X_l2l1 = HPolyhedron([HalfSpace([1.0; 0.0; z], 0.0),  # x &lt;= 0
                          HalfSpace([-0.714286; -1.0; z], 0.0),  # 0.714286*x + y &gt;= 0
                          HalfSpace([0.714286; 1.0; z], 0.0)])  # 0.714286*x + y &lt;= 0
    r3 = ConstrainedIdentityMap(n, X_l2l1)

    ## transition l1 -&gt; l3
    X_l1l3 = HPolyhedron([HalfSpace([-0.714286; -1.0; z], 0.0),  # 0.714286*x + y &gt;= 0
                          HalfSpace([-1.0; 0.0; z], 0.0),  # x &gt;= 0
                          HalfSpace([1.0; 0.0; z], 0.0)])  # x &lt;= 0
    r4 = ConstrainedIdentityMap(n, X_l1l3)

    r = [r1, r2, r3, r4]

    ## switchings
    s = [HybridSystems.AutonomousSwitching()]

    return HybridSystem(a, m, r, s)
end

function fosc(X0; n0::Int=4, one_loop_iteration::Bool=false)
    H = filtered_oscillator_hybrid(n0, one_loop_iteration)
    return IVP(H, [(1, X0)])
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">fosc (generic function with 1 method)</code></pre><h2 id="Results"><a class="docs-heading-anchor" href="#Results">Results</a><a id="Results-1"></a><a class="docs-heading-anchor-permalink" href="#Results" title="Permalink"></a></h2></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../benchmarks/">« Benchmark repository</a><a class="docs-footer-nextpage" href="../../examples_overview/">Overview »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Friday 5 September 2025 04:34">Friday 5 September 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
