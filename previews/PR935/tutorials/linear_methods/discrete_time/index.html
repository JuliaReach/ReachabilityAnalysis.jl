<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Discrete time reachability · ReachabilityAnalysis.jl</title><meta name="title" content="Discrete time reachability · ReachabilityAnalysis.jl"/><meta property="og:title" content="Discrete time reachability · ReachabilityAnalysis.jl"/><meta property="twitter:title" content="Discrete time reachability · ReachabilityAnalysis.jl"/><meta name="description" content="Documentation for ReachabilityAnalysis.jl."/><meta property="og:description" content="Documentation for ReachabilityAnalysis.jl."/><meta property="twitter:description" content="Documentation for ReachabilityAnalysis.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/aligned.css" rel="stylesheet" type="text/css"/><link href="../../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="ReachabilityAnalysis.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">ReachabilityAnalysis.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Overview</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Set representations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../set_representations/zonotopes/">Zonotopic sets</a></li><li><a class="tocitem" href="../../set_representations/polyhedral_computations/">Polyhedral computations</a></li><li><a class="tocitem" href="../../set_representations/distances/">Metric notions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Linear methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../introduction/">Introduction</a></li><li class="is-active"><a class="tocitem" href>Discrete time reachability</a><ul class="internal"><li><a class="tocitem" href="#Set-propagation-in-discrete-time"><span>Set propagation in discrete time</span></a></li><li><a class="tocitem" href="#What-is-a-flowpipe?"><span>What is a flowpipe?</span></a></li></ul></li><li><a class="tocitem" href="../dense_time/">Dense time reachability</a></li><li><a class="tocitem" href="../../../generated_examples/ISS/">International Space Station</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Modeling uncertain inputs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated_examples/Building/">Building model</a></li><li><a class="tocitem" href="../../../generated_examples/OpAmp/">Operational amplifier</a></li><li><a class="tocitem" href="../../../generated_examples/TransmissionLine/">Transmission line</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Taylor methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../taylor_methods/introduction/">Introduction</a></li><li><a class="tocitem" href="../../taylor_methods/domain_splitting/">Domain splitting</a></li><li><a class="tocitem" href="../../taylor_methods/gotchas/">Common gotchas</a></li><li><a class="tocitem" href="../../../generated_examples/LotkaVolterra/">Lotka-Volterra</a></li><li><a class="tocitem" href="../../../generated_examples/VanDerPol/">Van der Pol oscillator</a></li><li><a class="tocitem" href="../../../generated_examples/Lorenz/">Lorenz system</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-5" type="checkbox"/><label class="tocitem" for="menuitem-2-5"><span class="docs-label">Parametric systems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../man/parametric/">Parametric reachability</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-6" type="checkbox"/><label class="tocitem" for="menuitem-2-6"><span class="docs-label">Hybrid systems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated_examples/SquareWaveOscillator/">Square wave oscillator</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-7" type="checkbox"/><label class="tocitem" for="menuitem-2-7"><span class="docs-label">Clocked systems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../generated_examples/Platoon/">Platoon</a></li><li><a class="tocitem" href="../../../generated_examples/EMBrake/">Electromechanical brake</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../man/systems/">Systems</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Linear solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../man/algorithms/A20/">A20</a></li><li><a class="tocitem" href="../../../man/algorithms/ASB07/">ASB07</a></li><li><a class="tocitem" href="../../../man/algorithms/BFFPSV18/">BFFPSV18</a></li><li><a class="tocitem" href="../../../man/algorithms/BOX/">BOX</a></li><li><a class="tocitem" href="../../../man/algorithms/GLGM06/">GLGM06</a></li><li><a class="tocitem" href="../../../man/algorithms/INT/">INT</a></li><li><a class="tocitem" href="../../../man/algorithms/LGG09/">LGG09</a></li><li><a class="tocitem" href="../../../man/algorithms/ORBIT/">ORBIT</a></li><li><a class="tocitem" href="../../../man/algorithms/VREP/">VREP</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Parametric solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../man/algorithms/HLBS25/">HLBS25</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Benchmarks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../man/benchmarks/repeatability/">Repeatability evaluations</a></li><li><a class="tocitem" href="../../../man/benchmarks/model_library/">Model library</a></li><li><a class="tocitem" href="../../../man/benchmarks/benchmarks/">Benchmark repository</a></li><li><a class="tocitem" href="../../../man/benchmarks/filtered_oscillator/">Filtered oscillator</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Further examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../man/examples_overview/">Overview</a></li><li><a class="tocitem" href="../../../generated_examples/DuffingOscillator/">Duffing oscillator</a></li><li><a class="tocitem" href="../../../generated_examples/LaubLoomis/">Laub-Loomis</a></li><li><a class="tocitem" href="../../../generated_examples/ProductionDestruction/">Production-Destruction</a></li><li><a class="tocitem" href="../../../generated_examples/Brusselator/">Brusselator</a></li><li><a class="tocitem" href="../../../generated_examples/Quadrotor/">Quadrotor</a></li><li><a class="tocitem" href="../../../generated_examples/SEIR/">Epidemic (SEIR) model</a></li><li><a class="tocitem" href="../../../generated_examples/Spacecraft/">Spacecraft</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../lib/systems/">Systems</a></li><li><a class="tocitem" href="../../../lib/reachsets/">Reach-sets</a></li><li><a class="tocitem" href="../../../lib/flowpipes/">Flowpipes</a></li><li><input class="collapse-toggle" id="menuitem-6-4" type="checkbox"/><label class="tocitem" for="menuitem-6-4"><span class="docs-label">Linear solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../lib/algorithms/A20/">A20</a></li><li><a class="tocitem" href="../../../lib/algorithms/ASB07/">ASB07</a></li><li><a class="tocitem" href="../../../lib/algorithms/BFFPSV18/">BFFPSV18</a></li><li><a class="tocitem" href="../../../lib/algorithms/BOX/">BOX</a></li><li><a class="tocitem" href="../../../lib/algorithms/GLGM06/">GLGM06</a></li><li><a class="tocitem" href="../../../lib/algorithms/INT/">INT</a></li><li><a class="tocitem" href="../../../lib/algorithms/LGG09/">LGG09</a></li><li><a class="tocitem" href="../../../lib/algorithms/ORBIT/">ORBIT</a></li><li><a class="tocitem" href="../../../lib/algorithms/VREP/">VREP</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-5" type="checkbox"/><label class="tocitem" for="menuitem-6-5"><span class="docs-label">Nonlinear solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../lib/algorithms/CARLIN/">CARLIN</a></li><li><a class="tocitem" href="../../../lib/algorithms/QINT/">QINT</a></li><li><a class="tocitem" href="../../../lib/algorithms/TMJets/">TMJets</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-6" type="checkbox"/><label class="tocitem" for="menuitem-6-6"><span class="docs-label">Parametric solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../lib/algorithms/HLBS25/">HLBS25</a></li></ul></li><li><a class="tocitem" href="../../../lib/solutions/">Solutions</a></li><li><a class="tocitem" href="../../../lib/discretize/">Discretization</a></li><li><a class="tocitem" href="../../../lib/projections/">Projections</a></li><li><a class="tocitem" href="../../../lib/clustering/">Clustering</a></li><li><a class="tocitem" href="../../../lib/operations/">Further set operations</a></li><li><a class="tocitem" href="../../../lib/distributed/">Distributed computations</a></li><li><a class="tocitem" href="../../../lib/internals/">Internal functions and macros</a></li></ul></li><li><a class="tocitem" href="../../../man/faq/">Frequently Asked Questions (FAQ)</a></li><li><a class="tocitem" href="../../../bibliography/">Bibliography</a></li><li><a class="tocitem" href="../../../about/">How to contribute</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li><a class="is-disabled">Linear methods</a></li><li class="is-active"><a href>Discrete time reachability</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Discrete time reachability</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaReach/ReachabilityAnalysis.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaReach/ReachabilityAnalysis.jl/blob/master/docs/src/tutorials/linear_methods/discrete_time.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h2 id="Set-propagation-in-discrete-time"><a class="docs-heading-anchor" href="#Set-propagation-in-discrete-time">Set propagation in discrete time</a><a id="Set-propagation-in-discrete-time-1"></a><a class="docs-heading-anchor-permalink" href="#Set-propagation-in-discrete-time" title="Permalink"></a></h2><p>Our motivating example is to solve the following simple linear set-based recurrence</p><p class="math-container">\[X_{k+1} = M(θ) X_k, \qquad 0 ≤ k ≤ 50, X_0 = [0.8, 1.2] \times [0.8, 1.2] ⊆ \mathbb{R}^2\]</p><p>Let <span>$θ ∈ [0, 2 π]$</span> be an equally spaced vector of length <span>$50$</span>, and <span>$M(θ)$</span> is the <a href="https://en.wikipedia.org/wiki/Rotation_matrix">rotation matrix</a> given by:</p><p class="math-container">\[M(θ) = \begin{pmatrix}\cosθ &amp;&amp; \sinθ \\ -\sinθ &amp;&amp; \cosθ \end{pmatrix}.\]</p><p>The matrix <span>$M(θ)$</span> rotates points in the xy-plane clockwise through an angle <span>$θ$</span> around the origin of a two-dimensional Cartesian coordinate system.</p><h3 id="Propagating-point-clouds"><a class="docs-heading-anchor" href="#Propagating-point-clouds">Propagating point clouds</a><a id="Propagating-point-clouds-1"></a><a class="docs-heading-anchor-permalink" href="#Propagating-point-clouds" title="Permalink"></a></h3><p>To gain some intuition, let&#39;s build the matrix and apply it to some points.</p><pre><code class="language-julia hljs">using ReachabilityAnalysis, Plots
using ReachabilityAnalysis: center

# initial set
X0 = BallInf(ones(2), 0.2)

# rotation matrix
M(θ) = [cos(θ) sin(θ); -sin(θ) cos(θ)]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">M (generic function with 1 method)</code></pre><pre><code class="language-julia hljs">fig = plot(X0, c=:white)
plot!(M(pi/4) * X0, c=:white)

# center of the initial set
c = center(X0) |&gt; Singleton

# list of vertices
V = vertices_list(X0) .|&gt; Singleton |&gt; UnionSetArray

plot!(c)
plot!(V)
plot!(M(pi/4) * c) # rotate 45 degrees
plot!(linear_map(M(pi/4), V))</code></pre><img src="81806dd4.png" alt="Example block output"/><pre><code class="language-julia hljs">X = sample(X0, 25) .|&gt; Singleton |&gt; UnionSetArray

plot!(X)
plot!(linear_map(M(pi/4), X), c=:blue)     # rotate 45 degrees
plot!(linear_map(M(pi/2), X), c=:green)    # rotate 90 degrees
plot!(linear_map(M(4pi/3), X), c=:orange)  # rotate 180 degrees

plot!(X0, c=:white)
plot!(M(pi/4) * X0, c=:white)
plot!(M(pi/2) * X0, c=:white)
plot!(M(4pi/3) * X0, c=:white)</code></pre><img src="21a7dc7c.svg" alt="Example block output"/><p>Does propagating point clouds solve the problem? Practically speaking, while we can compute the successors of any <span>$x_0 ∈ X_0$</span> we still lack a <em>global</em> description of the set according the the given discrete recurrence.. which brings us back to the original question: how to represent the solution of the recurrence for <em>all points in simultaneous</em>?</p><h3 id="Propagating-zonotopes"><a class="docs-heading-anchor" href="#Propagating-zonotopes">Propagating zonotopes</a><a id="Propagating-zonotopes-1"></a><a class="docs-heading-anchor-permalink" href="#Propagating-zonotopes" title="Permalink"></a></h3><p>The set representation that is most effective to this problem are <em>zonotopes</em> since they are closed under linear maps. Moreover, since the initial states is a hyperrectangle (thus a zonotope), we can propagate the whole set exactly (and efficiently).</p><p>We now implement the solution by propagating zonotopes.</p><pre><code class="language-julia hljs"># map X0 according to the rotation matrix
X0z = convert(Zonotope, X0)

arr = [linear_map(M(θi), X0z) for θi in range(0, 2pi, length=50)]

fig = plot(arr, ratio=1., alpha=1.)
plot!(X0, lw=2.0, ls=:dash, alpha=1., c=:white)</code></pre><img src="acee946f.png" alt="Example block output"/><pre><code class="language-julia hljs">typeof(arr)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Vector{Zonotope{Float64, Vector{Float64}, Matrix{Float64}}}<span class="sgr90"> (alias for Array{Zonotope{Float64, Array{Float64, 1}, Array{Float64, 2}}, 1})</span></code></pre><pre><code class="language-julia hljs">X0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BallInf{Float64, Vector{Float64}}([1.0, 1.0], 0.2)</code></pre><pre><code class="language-julia hljs">convert(Zonotope, X0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Zonotope{Float64, Vector{Float64}, Matrix{Float64}}([1.0, 1.0], [0.2 0.0; 0.0 0.2])</code></pre><pre><code class="language-julia hljs">genmat(arr[1])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2×2 Matrix{Float64}:
 0.2  0.0
 0.0  0.2</code></pre><p>(do <code>?Zonotope</code> for the docstring)</p><pre><code class="language-julia hljs">genmat(arr[2])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2×2 Matrix{Float64}:
  0.198358   0.0255754
 -0.0255754  0.198358</code></pre><pre><code class="language-julia hljs">M(2pi/50) * genmat(arr[1])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2×2 Matrix{Float64}:
  0.198423   0.0250666
 -0.0250666  0.198423</code></pre><p>The set effectively rotates clockwise around the origin:</p><pre><code class="language-julia hljs">fig = plot(Singleton(zeros(2)))
plot!(arr[1:10], ratio=1., alpha=1.)
plot!(X0, lw=2.0, ls=:dash, alpha=1., c=:white)</code></pre><img src="d7953bc8.png" alt="Example block output"/><div class="admonition is-info" id="Animations-with-Plots-57d3fbee9f31403c"><header class="admonition-header">Animations with Plots<a class="admonition-anchor" href="#Animations-with-Plots-57d3fbee9f31403c" title="Permalink"></a></header><div class="admonition-body"><p>The Julia package Plots.jl has a <code>@gif</code> functionality that can be used to created animated gifs. The following code animates the solution at 15 frames per second (fps).</p><pre><code class="language-julia hljs"># map X0 according to the rotation matrix
X0z = convert(Zonotope, X0)

fig = plot()
anim = @animate for θi in range(0, 2pi, length=50)
    plot!(fig, linear_map(M(θi), X0z), lw=2.0, alpha=1., lab=&quot;&quot;)
    xlims!(-3, 3)
    ylims!(-2, 2)
end
gif(anim, fps=15)</code></pre></div></div><p>Now we will use <em>reach-sets</em> and associate the angle <span>$θ$</span> with the time field.</p><pre><code class="language-julia hljs"># propagate sets passing the time point (angle)
Rsets = [ReachSet(M(θi) * X0, θi) for θi in range(0, 2pi, length=50)]</code></pre><p>We can pass an array of reach-sets to the plotting function:</p><pre><code class="language-julia hljs">fig = plot(Rsets, vars=(1, 2), xlab=&quot;x&quot;, ylab=&quot;y&quot;, ratio=1., c=:blue)
plot!(X0, c=:white, alpha=.6)</code></pre><img src="f48835e8.png" alt="Example block output"/><p>Since reach-sets have time information, we can also plot the sequence <em>in time</em>.</p><pre><code class="language-julia hljs">fig = plot(Rsets, vars=(0, 1), xlab=&quot;t&quot;, lab=&quot;x(t)&quot;, lw=2.0, lc=:blue, alpha=1.)
plot!(Rsets, vars=(0, 2), lab=&quot;y(t)&quot;, lw=2.0, lc=:orange, alpha=1.)</code></pre><img src="7a51979b.png" alt="Example block output"/><h2 id="What-is-a-flowpipe?"><a class="docs-heading-anchor" href="#What-is-a-flowpipe?">What is a flowpipe?</a><a id="What-is-a-flowpipe?-1"></a><a class="docs-heading-anchor-permalink" href="#What-is-a-flowpipe?" title="Permalink"></a></h2><p>A <strong>flowpipe</strong> is a collection of reach-sets which behaves like their (set) union. Flowpipes attain the right level of abstraction in order to represent solutions of set-based problems.</p><p>We can instantiate a flowpipe by passing an array of reach-sets.</p><pre><code class="language-julia hljs">arr = [ReachSet(M(θi) * X0, θi) for θi in range(0, 2pi, length=50)]

F = Flowpipe(arr)
typeof(F)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Flowpipe{Float64, ReachSet{Float64, LinearMap{Float64, BallInf{Float64, Vector{Float64}}, Float64, Matrix{Float64}}}, Vector{ReachSet{Float64, LinearMap{Float64, BallInf{Float64, Vector{Float64}}, Float64, Matrix{Float64}}}}}</code></pre><p>We can plot flowpipes, and all the reach-sets are plotted with the same color.</p><pre><code class="language-julia hljs">fig = plot(F, vars=(1, 2), ratio=1.)</code></pre><img src="51a1951c.png" alt="Example block output"/><p>Flowpipes implement Julia&#39;s array interface.</p><pre><code class="language-julia hljs">length(F)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">50</code></pre><p>For instance, do <code>F[1:3:end]</code> to plot one every three elements:</p><pre><code class="language-julia hljs">plot!(F[1:3:end], vars=(1, 2), c=:red)</code></pre><img src="3a79cacf.png" alt="Example block output"/><p>Of course, it is also possible to use the wrapped array (do <code>array(F)</code>) directly. However, flowpipes can be used to filter reach-sets in time, among other operations.</p><pre><code class="language-julia hljs">tspan.(F[1:5]) # time span of the first five reach-sets</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5-element Vector{IntervalArithmetic.Interval{Float64}}:
 [0, 0]
     [0.128228, 0.128229]
     [0.256456, 0.256457]
     [0.384684, 0.384685]
     [0.512913, 0.512914]</code></pre><pre><code class="language-julia hljs">F(2pi) # find the reach-set at time t = 2pi</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ReachSet{Float64, LinearMap{Float64, BallInf{Float64, Vector{Float64}}, Float64, Matrix{Float64}}}(LinearMap{Float64, BallInf{Float64, Vector{Float64}}, Float64, Matrix{Float64}}([1.0 -2.4492935982947064e-16; 2.4492935982947064e-16 1.0], BallInf{Float64, Vector{Float64}}([1.0, 1.0], 0.2)), [6.28318, 6.28319])</code></pre><p>We can also pick, or filter, those reach-sets whose intersection is non-empty with a given time interval.</p><pre><code class="language-julia hljs">F(2.5 .. 3.0) # returns a view</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">4-element view(::Vector{ReachSet{Float64, LinearMap{Float64, BallInf{Float64, Vector{Float64}}, Float64, Matrix{Float64}}}}, [21, 22, 23, 24]) with eltype ReachSet{Float64, LinearMap{Float64, BallInf{Float64, Vector{Float64}}, Float64, Matrix{Float64}}}:
 ReachSet{Float64, LinearMap{Float64, BallInf{Float64, Vector{Float64}}, Float64, Matrix{Float64}}}(LinearMap{Float64, BallInf{Float64, Vector{Float64}}, Float64, Matrix{Float64}}([-0.8380881048918406 0.5455349012105487; -0.5455349012105487 -0.8380881048918406], BallInf{Float64, Vector{Float64}}([1.0, 1.0], 0.2)), [2.56456, 2.56457])
 ReachSet{Float64, LinearMap{Float64, BallInf{Float64, Vector{Float64}}, Float64, Matrix{Float64}}}(LinearMap{Float64, BallInf{Float64, Vector{Float64}}, Float64, Matrix{Float64}}([-0.900968867902419 0.43388373911755823; -0.43388373911755823 -0.900968867902419], BallInf{Float64, Vector{Float64}}([1.0, 1.0], 0.2)), [2.69279, 2.6928])
 ReachSet{Float64, LinearMap{Float64, BallInf{Float64, Vector{Float64}}, Float64, Matrix{Float64}}}(LinearMap{Float64, BallInf{Float64, Vector{Float64}}, Float64, Matrix{Float64}}([-0.9490557470106686 0.3151082180236209; -0.3151082180236209 -0.9490557470106686], BallInf{Float64, Vector{Float64}}([1.0, 1.0], 0.2)), [2.82102, 2.82103])
 ReachSet{Float64, LinearMap{Float64, BallInf{Float64, Vector{Float64}}, Float64, Matrix{Float64}}}(LinearMap{Float64, BallInf{Float64, Vector{Float64}}, Float64, Matrix{Float64}}([-0.9815591569910653 0.19115862870137254; -0.19115862870137254 -0.9815591569910653], BallInf{Float64, Vector{Float64}}([1.0, 1.0], 0.2)), [2.94925, 2.94926])</code></pre><p>We can also filter by a condition on the time span using <code>tstart</code> and <code>tend</code>:</p><pre><code class="language-julia hljs"># get all reach-sets from time t = 4 onwards
aux = F(4 .. tend(F));

length(aux)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">18</code></pre><pre><code class="language-julia hljs">fig = plot(F, vars=(0, 1), xlab=&quot;t&quot;, ylab=&quot;x&quot;, lw=2.0, alpha=1.)

# get all those reach-set whose time span is greater than 40
plot!(aux, vars=(0, 1), lw=2.0, lc=:red, alpha=1.)</code></pre><img src="437d7422.png" alt="Example block output"/><p>Finally, observe that set operations with flowpipes are also supported. The following example intersects the flowpipe <span>$F$</span> with a half-space.</p><pre><code class="language-julia hljs">H  = HalfSpace([1, 1.], 1.) # x + y ≤ 1

Q = F ∩ H  # perform a lazy intersection

# plot the result
fig = plot(H, alpha=.3, lab=&quot;H&quot;, c=:grey)
plot!(F ∩ H, vars=(1, 2), ratio=1., lab=&quot;F ∩ H&quot;)
xlims!(-2.0, 2.0); ylims!(-2, 2.)</code></pre><img src="dbbc27a5.png" alt="Example block output"/><h3 id="Using-the-solve-interface-for-discrete-problems"><a class="docs-heading-anchor" href="#Using-the-solve-interface-for-discrete-problems">Using the solve interface for discrete problems</a><a id="Using-the-solve-interface-for-discrete-problems-1"></a><a class="docs-heading-anchor-permalink" href="#Using-the-solve-interface-for-discrete-problems" title="Permalink"></a></h3><p>By default, the <code>solve</code> interface propagates sets in dense time (as explained in the next section). However, it is possible to propagate sets in discrete time by specifying that the approximation model should not add any bloating to the initial states, <code>approx_model=NoBloating()</code> to the solver used.</p><p><strong>Exercise.</strong> Solve the linear set based recurrence in the current section using the <code>solve</code> interface. Hint: use the algorithm <code>alg=GLGM06(δ=0.05, approx_model=NoBloating())</code> and the state matrix as specified in the following section.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../introduction/">« Introduction</a><a class="docs-footer-nextpage" href="../dense_time/">Dense time reachability »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 23 September 2025 02:04">Tuesday 23 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
