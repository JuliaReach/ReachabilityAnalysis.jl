<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Operational amplifier · ReachabilityAnalysis.jl</title><meta name="title" content="Operational amplifier · ReachabilityAnalysis.jl"/><meta property="og:title" content="Operational amplifier · ReachabilityAnalysis.jl"/><meta property="twitter:title" content="Operational amplifier · ReachabilityAnalysis.jl"/><meta name="description" content="Documentation for ReachabilityAnalysis.jl."/><meta property="og:description" content="Documentation for ReachabilityAnalysis.jl."/><meta property="twitter:description" content="Documentation for ReachabilityAnalysis.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/aligned.css" rel="stylesheet" type="text/css"/><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="ReachabilityAnalysis.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ReachabilityAnalysis.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Overview</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Set representations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/set_representations/zonotopes/">Zonotopic sets</a></li><li><a class="tocitem" href="../../tutorials/set_representations/polyhedral_computations/">Polyhedral computations</a></li><li><a class="tocitem" href="../../tutorials/set_representations/distances/">Metric notions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Linear methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/linear_methods/introduction/">Introduction</a></li><li><a class="tocitem" href="../../tutorials/linear_methods/discrete_time/">Discrete time reachability</a></li><li><a class="tocitem" href="../../tutorials/linear_methods/dense_time/">Dense time reachability</a></li><li><a class="tocitem" href="../ISS/">International Space Station</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox" checked/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Modeling uncertain inputs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../Building/">Building model</a></li><li class="is-active"><a class="tocitem" href>Operational amplifier</a><ul class="internal"><li><a class="tocitem" href="#Inverting-amplifier"><span>Inverting amplifier</span></a></li><li><a class="tocitem" href="#Nondeterministic-input"><span>Nondeterministic input</span></a></li><li><a class="tocitem" href="#Constant-input"><span>Constant input</span></a></li><li><a class="tocitem" href="#Time-varying-input"><span>Time-varying input</span></a></li><li><a class="tocitem" href="#Specification-2"><span>Specification</span></a></li><li><a class="tocitem" href="#Analysis-3"><span>Analysis</span></a></li><li><a class="tocitem" href="#Results-3"><span>Results</span></a></li></ul></li><li><a class="tocitem" href="../TransmissionLine/">Transmission line</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Taylor methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/taylor_methods/introduction/">Introduction</a></li><li><a class="tocitem" href="../../tutorials/taylor_methods/domain_splitting/">Domain splitting</a></li><li><a class="tocitem" href="../../tutorials/taylor_methods/gotchas/">Common gotchas</a></li><li><a class="tocitem" href="../LotkaVolterra/">Lotka-Volterra</a></li><li><a class="tocitem" href="../VanDerPol/">Van der Pol oscillator</a></li><li><a class="tocitem" href="../Lorenz/">Lorenz system</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-5" type="checkbox"/><label class="tocitem" for="menuitem-2-5"><span class="docs-label">Hybrid systems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../SquareWaveOscillator/">Square wave oscillator</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-6" type="checkbox"/><label class="tocitem" for="menuitem-2-6"><span class="docs-label">Clocked systems</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../Platoon/">Platoon</a></li><li><a class="tocitem" href="../EMBrake/">Electromechanical brake</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../man/systems/">Systems</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Linear solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../man/algorithms/A20/">A20</a></li><li><a class="tocitem" href="../../man/algorithms/ASB07/">ASB07</a></li><li><a class="tocitem" href="../../man/algorithms/BFFPSV18/">BFFPSV18</a></li><li><a class="tocitem" href="../../man/algorithms/BOX/">BOX</a></li><li><a class="tocitem" href="../../man/algorithms/GLGM06/">GLGM06</a></li><li><a class="tocitem" href="../../man/algorithms/INT/">INT</a></li><li><a class="tocitem" href="../../man/algorithms/LGG09/">LGG09</a></li><li><a class="tocitem" href="../../man/algorithms/ORBIT/">ORBIT</a></li><li><a class="tocitem" href="../../man/algorithms/VREP/">VREP</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Benchmarks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../man/benchmarks/repeatability/">Repeatability evaluations</a></li><li><a class="tocitem" href="../../man/benchmarks/model_library/">Model library</a></li><li><a class="tocitem" href="../../man/benchmarks/benchmarks/">Benchmark repository</a></li><li><a class="tocitem" href="../../man/benchmarks/filtered_oscillator/">Filtered oscillator</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Further examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../man/examples_overview/">Overview</a></li><li><a class="tocitem" href="../DuffingOscillator/">Duffing oscillator</a></li><li><a class="tocitem" href="../LaubLoomis/">Laub-Loomis</a></li><li><a class="tocitem" href="../ProductionDestruction/">Production-Destruction</a></li><li><a class="tocitem" href="../Brusselator/">Brusselator</a></li><li><a class="tocitem" href="../Quadrotor/">Quadrotor</a></li><li><a class="tocitem" href="../SEIR/">Epidemic (SEIR) model</a></li><li><a class="tocitem" href="../Spacecraft/">Spacecraft</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lib/systems/">Systems</a></li><li><a class="tocitem" href="../../lib/reachsets/">Reach-sets</a></li><li><a class="tocitem" href="../../lib/flowpipes/">Flowpipes</a></li><li><input class="collapse-toggle" id="menuitem-6-4" type="checkbox"/><label class="tocitem" for="menuitem-6-4"><span class="docs-label">Linear solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lib/algorithms/A20/">A20</a></li><li><a class="tocitem" href="../../lib/algorithms/ASB07/">ASB07</a></li><li><a class="tocitem" href="../../lib/algorithms/BFFPSV18/">BFFPSV18</a></li><li><a class="tocitem" href="../../lib/algorithms/BOX/">BOX</a></li><li><a class="tocitem" href="../../lib/algorithms/GLGM06/">GLGM06</a></li><li><a class="tocitem" href="../../lib/algorithms/INT/">INT</a></li><li><a class="tocitem" href="../../lib/algorithms/LGG09/">LGG09</a></li><li><a class="tocitem" href="../../lib/algorithms/ORBIT/">ORBIT</a></li><li><a class="tocitem" href="../../lib/algorithms/VREP/">VREP</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-5" type="checkbox"/><label class="tocitem" for="menuitem-6-5"><span class="docs-label">Nonlinear solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lib/algorithms/CARLIN/">CARLIN</a></li><li><a class="tocitem" href="../../lib/algorithms/QINT/">QINT</a></li><li><a class="tocitem" href="../../lib/algorithms/TMJets/">TMJets</a></li></ul></li><li><a class="tocitem" href="../../lib/solutions/">Solutions</a></li><li><a class="tocitem" href="../../lib/discretize/">Discretization</a></li><li><a class="tocitem" href="../../lib/projections/">Projections</a></li><li><a class="tocitem" href="../../lib/clustering/">Clustering</a></li><li><a class="tocitem" href="../../lib/operations/">Further set operations</a></li><li><a class="tocitem" href="../../lib/distributed/">Distributed computations</a></li><li><a class="tocitem" href="../../lib/internals/">Internal functions and macros</a></li></ul></li><li><a class="tocitem" href="../../man/faq/">Frequently Asked Questions (FAQ)</a></li><li><a class="tocitem" href="../../bibliography/">Bibliography</a></li><li><a class="tocitem" href="../../about/">How to contribute</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li><a class="is-disabled">Modeling uncertain inputs</a></li><li class="is-active"><a href>Operational amplifier</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Operational amplifier</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaReach/ReachabilityAnalysis.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaReach/ReachabilityAnalysis.jl/blob/master/examples/OpAmp/OpAmp.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Operational-Amplifier"><a class="docs-heading-anchor" href="#Operational-Amplifier">Operational Amplifier</a><a id="Operational-Amplifier-1"></a><a class="docs-heading-anchor-permalink" href="#Operational-Amplifier" title="Permalink"></a></h1><div class="admonition is-info" id="Overview-5afc70a1cd4a2783"><header class="admonition-header">Overview<a class="admonition-anchor" href="#Overview-5afc70a1cd4a2783" title="Permalink"></a></header><div class="admonition-body"><p>System type: Linear continuous system<br/>State dimension: 2<br/>Application domain: Electrical engineering</p></div></div><p>Operational amplifiers (&quot;op-amp&quot;) are electronic devices to amplify an input voltage signal. They are widely used to construct filters that remove a desired range of frequencies from the input signal.</p><p>The schematic diagram of an op-amp has two terminals:</p><ul><li>input terminal (left)</li><li>output terminal (right)</li></ul><p>The output voltage is <span>$e_{out} = K(e_B - e_A)$</span>, where <span>$K$</span> is the voltage gain of the op-amp, which is usually very large (at the order of <span>$10^5 V / V$</span>).</p><p>In the <em>ideal op-amp</em> scenario, the following assumptions hold:</p><ul><li>The input terminals of the op-amp draw negligible current.</li><li>The voltage difference at the input terminals <span>$e_B - e_A$</span> is zero.</li><li>The gain <span>$K$</span> is infinite.</li></ul><h2 id="Inverting-amplifier"><a class="docs-heading-anchor" href="#Inverting-amplifier">Inverting amplifier</a><a id="Inverting-amplifier-1"></a><a class="docs-heading-anchor-permalink" href="#Inverting-amplifier" title="Permalink"></a></h2><p>Consider the following circuit, which consists of an ideal op-amp in the so-called inverting configuration.</p><p><img src="../opamp_c.png" alt/></p><p>It is not hard to show [<a href="../../bibliography/#Kluever20">Klu20</a>] that the output satisfies the following differential equation:</p><p class="math-container">\[   \dfrac{d e_{out}(t)}{dt} = -\dfrac{1}{R_2 C}e_{out}(t) - \dfrac{1}{R_1C}e_{in}(t).\]</p><p>The circuit exhibits a transient behavior because of the capacitor connected in parallel to the op-amp. In the stationary limit <span>$t → ∞$</span>, <span>$\dfrac{d e_{out}(t)}{dt} = 0$</span> and <span>$e_{out} = - \dfrac{R_2}{R_1} e_{in}$</span>. The gain is thus <span>$-\dfrac{R_2}{R_1}$</span> and the minus sign is the reason that this circuit is called &quot;inverting amplifier.&quot;</p><p>The output voltage <span>$e_{out}(t)$</span> depends on the input voltage <span>$e_{in}(t)$</span>. In order to highlight some typical assumptions on the inputs, in the rest of this notebook we model the input voltage in different ways:</p><ol><li><p><strong>Nondeterministic input</strong> with bounded range. This is the most general case, in which <span>$e_{in}(t) ∈ E_{in}$</span>, with <span>$E_{in} ⊆ \mathbb{R}$</span> is an interval for the set of admissible inputs. This approach guarantees that the flowpipe covers all possible trajectories for any bounded and measurable function <span>$e_{in}(t)$</span> satisfying the constraint <span>$e_{in}(t) ∈ E_{in}$</span> for all <span>$t$</span> of the given time span.</p></li><li><p><strong>Constant input</strong>, a special case such that <span>$e_{in}(t) ∈ E_{in}$</span> and <span>$e_{in}(t)$</span> is <em>constant</em> along trajectories.</p></li><li><p><strong>Time-varying input</strong> such that the input is determined by a (possibly time-varying) predefined function <span>$e_{in}(t)$</span> that is given by the solution of some differential equation. In particular, we consider linear and exponential input functions.</p></li></ol><p>In the following sections, we will consider these three different scenarios.</p><h2 id="Nondeterministic-input"><a class="docs-heading-anchor" href="#Nondeterministic-input">Nondeterministic input</a><a id="Nondeterministic-input-1"></a><a class="docs-heading-anchor-permalink" href="#Nondeterministic-input" title="Permalink"></a></h2><p>In this section, we assume that the input voltage <span>$e_{in}(t)$</span> can be any (measurable) function whose range is contained in the set <span>$E_{in}$</span>.</p><h3 id="Model"><a class="docs-heading-anchor" href="#Model">Model</a><a id="Model-1"></a><a class="docs-heading-anchor-permalink" href="#Model" title="Permalink"></a></h3><p>It is convenient to define constants <span>$α$</span> and <span>$β$</span> such that <span>$\dfrac{d e_{out}(t)}{dt} = α e_{out}(t) + β e_{in}(t)$</span>.</p><pre><code class="language-julia hljs">using ReachabilityAnalysis

function opamp_nondet(; X0=Singleton([0.0]),
                      R₁=2.0, R₂=6.0, C=1.e-3,
                      Ein=Interval(1.9, 2.1))
    α = hcat(-1 / (R₂ * C))
    β = hcat(-1 / (R₁ * C))

    # continuous evolution
    sys = @system(eout&#39; = α * eout + β * ein, ein ∈ Ein, eout ∈ Universe(1))

    # initial-value problem
    return @ivp(sys, x(0) ∈ X0)
end;</code></pre><h3 id="Analysis"><a class="docs-heading-anchor" href="#Analysis">Analysis</a><a id="Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis" title="Permalink"></a></h3><pre><code class="language-julia hljs">sol_nondet = solve(opamp_nondet(); T=0.1, alg=INT(; δ=1e-4));</code></pre><div class="admonition is-success" id="Performance-tip-2ecaea78dabd0528"><header class="admonition-header">Performance tip<a class="admonition-anchor" href="#Performance-tip-2ecaea78dabd0528" title="Permalink"></a></header><div class="admonition-body"><p>We have chosen the algorithm <code>INT</code>, as it is the best choice in terms     of efficiency for one-dimensional ODEs.</p></div></div><h3 id="Results"><a class="docs-heading-anchor" href="#Results">Results</a><a id="Results-1"></a><a class="docs-heading-anchor-permalink" href="#Results" title="Permalink"></a></h3><pre><code class="language-julia hljs">using Plots, LaTeXStrings

fig = plot(sol_nondet; vars=(0, 1), xlab=L&quot;t&quot;, ylab=L&quot;e_{out}&quot;,
           title=&quot;Solution for nondeterministic input&quot;, lw=0.2)</code></pre><img src="b8ee582a.png" alt="Example block output"/><p>The solution <code>sol_nondet</code> assumed that the initial state is at the origin. Now we solve for three different initial conditions of increasing width, for a shorter time horizon.</p><pre><code class="language-julia hljs">Δt = 0 .. 0.04

fig = plot(; xlab=L&quot;t&quot;, ylab=L&quot;e_{out}(t)&quot;, title=&quot;Solution for nondeterministic input&quot;)

sol_nondet = solve(opamp_nondet(; X0=Interval(-1.0, 1.0)); T=0.1, alg=INT(; δ=1e-4))
plot!(fig, sol_nondet(Δt); vars=(0, 1), lab=&quot;X0 = -1 .. 1&quot;, lw=0.2)

sol_nondet = solve(opamp_nondet(; X0=Interval(-0.5, 0.5)); T=0.1, alg=INT(; δ=1e-4))
plot!(fig, sol_nondet(Δt); vars=(0, 1), lab=&quot;X0 = -0.5 .. 0.5&quot;, lw=0.2)

sol_nondet = solve(opamp_nondet(); T=0.1, alg=INT(; δ=1e-4))
plot!(fig, sol_nondet(Δt); vars=(0, 1), lab=&quot;X0 = 0&quot;, lw=0.2)</code></pre><img src="01b69add.png" alt="Example block output"/><div class="admonition is-success" id="Visualization-tip-f4dcc327e0956fdd"><header class="admonition-header">Visualization tip<a class="admonition-anchor" href="#Visualization-tip-f4dcc327e0956fdd" title="Permalink"></a></header><div class="admonition-body"><p>The order in which we have plotted the solutions is such that the flowpipe with largest width comes first, so it does not overlap with flowpipes which are strictly included in it.</p></div></div><h2 id="Constant-input"><a class="docs-heading-anchor" href="#Constant-input">Constant input</a><a id="Constant-input-1"></a><a class="docs-heading-anchor-permalink" href="#Constant-input" title="Permalink"></a></h2><p>In this section, we model the input voltage <span>$e_{in}(t)$</span> with a family of differential equations of the form <span>$\dfrac{d e_{in}(t)}{dt} = γ e_{in}(t) + δ$</span>.</p><h3 id="Model-2"><a class="docs-heading-anchor" href="#Model-2">Model</a><a class="docs-heading-anchor-permalink" href="#Model-2" title="Permalink"></a></h3><p>There are two distinct behaviors depending on the parameters <span>$γ$</span> and <span>$δ$</span>:</p><ul><li><span>$γ = δ = 0$</span>: the input is constant, <span>$e_{in}(t) = e_{in, 0}$</span>.</li><li><span>$γ = 0$</span>, <span>$δ ≠ 0$</span>: the input is given by linear with rate <span>$δ$</span>, <span>$e_{in}(t) = δ t + e_{in, 0}$</span>.</li><li><span>$γ ≠ 0$</span>, <span>$δ ≠ 0$</span>: the input is exponential with rate <span>$γ$</span>, <span>$e_{in}(t) = (e_{in, 0} + δ / γ)e^{γ t} - δ / γ$</span>.</li></ul><p>Moreover, it is natural to assume that the input saturates at a given threshold value. The following function, <code>opamp_with_saturation</code>, models the system as a hybrid automaton with two modes: in the first mode, the input signal <span>$e_{in}(t)$</span> varies according to the specified dynamics, and in the second mode, the input signal saturates and ceases to increase (or decrease, depding on the signs chosen). Observe that there are now two state dimensions. The first coordinate corresponds to the output <span>$e_{out}(t)$</span>, while the second coordinate, <span>$e_{in}(t)$</span>, corresponds to the input signal <span>$e_{in}(t)$</span>.</p><p>In this section, we consider the constant input scenario: <span>$e_{in}(0) ∈ E_{in, 0}$</span>, <span>$e_{in}(t)$</span> constant and <span>$γ = δ = 0$</span>. We will consider the other cases in the next section.</p><pre><code class="language-julia hljs">using Symbolics

function opamp_with_saturation(; X0=Singleton(zeros(2)),
                               R₁=2.0, R₂=6.0, C=1.e-3,
                               γ=100.0, δ=100.0, Es=2.0)
    var = @variables eₒ ein
    α = hcat(-1 / (R₂ * C))
    β = hcat(-1 / (R₁ * C))

    # transition graph
    automaton = GraphAutomaton(2)
    add_transition!(automaton, 1, 2, 1)

    # modes
    A = [α β; 0 γ]
    b = [0; δ]
    mode1 = @system(x&#39; = Ax + b, x ∈ HalfSpace(ein &lt;= Es, var))
    A = [α β; 0 0]
    mode2 = @system(x&#39; = Ax, x ∈ Universe(2))
    modes = [mode1, mode2]

    # transition mode1 -&gt; mode2 (saturation)
    t1 = @map(x -&gt; x, dim:2, x ∈ Hyperplane(ein == Es, var))
    resetmaps = [t1]

    # initial condition: at the origin in mode 1
    initial_condition = [(1, X0)]

    H = HybridSystem(automaton, modes, resetmaps, [AutonomousSwitching()])
    return IVP(H, initial_condition)
end;</code></pre><h3 id="Specification"><a class="docs-heading-anchor" href="#Specification">Specification</a><a id="Specification-1"></a><a class="docs-heading-anchor-permalink" href="#Specification" title="Permalink"></a></h3><p>We choose the initial condition such that <span>$e_{out}(0)$</span> is at the origin and <span>$e_{in}(0) ∈ [1.4, 1.6]$</span>.</p><pre><code class="language-julia hljs">X0 = Hyperrectangle([0.0, 1.5], [0.0, 0.1]);</code></pre><p>The value of the saturation constant <span>$Es$</span> is chosen to be sufficiently high such that the system does not transition to mode 2.</p><pre><code class="language-julia hljs">prob_const = opamp_with_saturation(; X0=X0, γ=0.0, δ=0.0, Es=3.0);</code></pre><h3 id="Analysis-2"><a class="docs-heading-anchor" href="#Analysis-2">Analysis</a><a class="docs-heading-anchor-permalink" href="#Analysis-2" title="Permalink"></a></h3><pre><code class="language-julia hljs">sol_const = solve(prob_const; T=0.1, alg=BOX(; δ=1e-4));</code></pre><h3 id="Results-2"><a class="docs-heading-anchor" href="#Results-2">Results</a><a class="docs-heading-anchor-permalink" href="#Results-2" title="Permalink"></a></h3><pre><code class="language-julia hljs">fig = plot(sol_const; vars=(0, 2), xlab=L&quot;t&quot;, ylab=L&quot;e_{in}(t)&quot;,
           title=&quot;Constant input signal&quot;, lw=0.2)
plot!(fig, x -&gt; x, x -&gt; 1.5, 0.0, 0.1; color=&quot;red&quot;, lw=2, ls=:dash, lab=&quot;&quot;)</code></pre><img src="ad25d533.png" alt="Example block output"/><pre><code class="language-julia hljs">fig = plot(sol_const; vars=(0, 1), xlab=L&quot;t&quot;, ylab=L&quot;e_{out}(t)&quot;,
           title=&quot;Solution for constant input&quot;, lw=0.2)</code></pre><img src="ad6b4b41.png" alt="Example block output"/><h2 id="Time-varying-input"><a class="docs-heading-anchor" href="#Time-varying-input">Time-varying input</a><a id="Time-varying-input-1"></a><a class="docs-heading-anchor-permalink" href="#Time-varying-input" title="Permalink"></a></h2><p>For the time-varying scenario with a prescribed function, we consider two cases:</p><ul><li>Linearly increasing input voltage: <span>$γ = 0$</span>, <span>$δ ≠ 0$</span>.</li><li>Exponentially increasing input voltage (up to saturation at <code>Es = 1.0</code>): <span>$γ &lt; 0$</span>, <span>$δ ≠ 0$</span>.</li></ul><h2 id="Specification-2"><a class="docs-heading-anchor" href="#Specification-2">Specification</a><a class="docs-heading-anchor-permalink" href="#Specification-2" title="Permalink"></a></h2><p>For both cases we consider the initial condition being the origin:</p><pre><code class="language-julia hljs">X0 = Singleton(zeros(2));</code></pre><p>We choose some values for <span>$δ$</span> and <span>$γ$</span>:</p><pre><code class="language-julia hljs">prob_lin = opamp_with_saturation(; X0=X0, γ=0.0, δ=100.0, Es=1.0)
prob_exp = opamp_with_saturation(; X0=X0, γ=-100.0, δ=100.0, Es=3.0);</code></pre><h2 id="Analysis-3"><a class="docs-heading-anchor" href="#Analysis-3">Analysis</a><a class="docs-heading-anchor-permalink" href="#Analysis-3" title="Permalink"></a></h2><pre><code class="language-julia hljs">sol_lin = solve(prob_lin; T=0.1, alg=BOX(; δ=1e-4))

sol_exp = solve(prob_exp; T=0.1, alg=BOX(; δ=1e-4));</code></pre><h2 id="Results-3"><a class="docs-heading-anchor" href="#Results-3">Results</a><a class="docs-heading-anchor-permalink" href="#Results-3" title="Permalink"></a></h2><pre><code class="language-julia hljs">fig = plot(sol_lin; vars=(0, 2), xlab=L&quot;t&quot;, ylab=L&quot;e_{in}(t)&quot;,
           title=&quot;Linear input with saturation&quot;, lw=0.2)</code></pre><img src="a42cbcce.png" alt="Example block output"/><pre><code class="language-julia hljs">fig = plot(sol_exp; vars=(0, 2), xlab=L&quot;t&quot;, ylab=L&quot;e_{in}(t)&quot;,
           title=&quot;Exponential input&quot;, lw=0.2)</code></pre><img src="8885c347.png" alt="Example block output"/><pre><code class="language-julia hljs">fig = plot(sol_lin; vars=(0, 1), xlab=L&quot;t&quot;, ylab=L&quot;e_{out}(t)&quot;,
           title=&quot;Solution for linear input&quot;, lw=0.2)</code></pre><img src="23cd7acd.png" alt="Example block output"/><pre><code class="language-julia hljs">fig = plot(sol_exp; vars=(0, 1), xlab=L&quot;t&quot;, ylab=L&quot;e_{out}(t)&quot;,
           title=&quot;Solution for exponential input&quot;, lw=0.2)</code></pre><img src="3790c87d.png" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Building/">« Building model</a><a class="docs-footer-nextpage" href="../TransmissionLine/">Transmission line »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Saturday 23 August 2025 08:37">Saturday 23 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
